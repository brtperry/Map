

(function (pieChart) {
    
    "use strict";
    var colours = ["#0066FF", "#FF0000", "#003366", "#FFCC00", "#8AB647", "#0033FF", "#989898"],
        total = 0,
        pie = [];

    function $el(id) {
        if (typeof id === 'string') {
            return document.getElementById(id);
        }
        return id;
    }
    function drawRectangle(ctx, x, y, w, h, c) {
        ctx.fillStyle = c;
        ctx.fillRect(x, y, w, h);
    }
    function setClass(e, cl) {
     
        $el(e).setAttribute((document.all ? "className" : "class"), cl);
    }
    function doPieChart() {

        var el = $el('canvas'),
            last = 0,
            ctx = el.getContext("2d"),
            oft = el.width,
            y = 20,
            radius = (el.height / 3.14),
            cX = radius + y,
            cY = (el.height / 2) - radius / 2,
            i = 0,
            anticlockwise = false,
            slice = 0,
            val = 0;
        
        ctx.font = "12px sans-serif";
        
        //drawslice(ctx,parseFloat(pie[0].value),cX,cY,radius,last);
        //return;

        for (i = 0; i < pie.length; i += 1) {
            
            val = parseFloat(pie[i].value);
            slice = (Math.PI * 2 * (val / total));
            ctx.fillStyle = colours[i];
            ctx.beginPath();
            ctx.moveTo(cX, cY);
            ctx.arc(cX, cY, radius, last, last + slice, anticlockwise);
            ctx.lineTo(cX, cY);
            ctx.fill();
            last += Math.PI * 2 * (val / total);
            drawRectangle(ctx, oft - 260, y + 30, 10, 10, colours[i]);
            ctx.fillStyle = 'black';
            ctx.fillText(pie[i].label, oft - 240, y + 40);

            y += 20;
        }
    }
    
    function drawslice(ctx, i, x, y, radius, lastPoint) {
        
        var slice = (Math.PI * 2 * (i / total));
        
            ctx.fillStyle = colours[i];
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.arc(x, y, radius, lastPoint, lastPoint + slice, false);
            ctx.lineTo(x, y);
            ctx.fill();

    }
    
    pieChart.load = function () {
        
        var rows = $el('charities').getElementsByTagName('tr'),
            i = 0;

        for (i = 0; i < rows.length; i += 1) {
            
            var th = rows[i].getElementsByTagName('th')[0],
                td = rows[i].getElementsByTagName('td')[0];

            total += parseFloat(td.innerHTML);
            pie.push({label: th.innerHTML, value: td.innerHTML});
        }
        setClass('charities', 'hidden');
        doPieChart();
    }

   pieChart.DoThis = function () {

tf += 1000;

     alert(tf);
  }

}(window.pieChart = window.pieChart || {}));

var tf = 10;

function that(e) {

alert(tf);

setTimeout(function() {andThis()
    // Whatever you want to do after the wait
}, 10000);


}

function andThis() {

tf *=4;

alert(tf);
}

window.onload = function () {
    "use strict";
    pieChart.load();

// nice function That is called first and then function DoThis.
 //pieChart.DoThis(that('brett'));

}